<html xmlns:th="http://www.thymeleaf.org">
	<th:block th:fragment="scripts">
		<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.8.4/moment.min.js"></script>
		
		<!-- Select2 -->
	    <link th:href="@{/assets/libs/select2/dist/css/select2.min.css}" rel="stylesheet" type="text/css"/>
	    <link th:href="@{/assets/libs/select2/dist/css/select2-bootstrap.css}" rel="stylesheet" type="text/css"/>
	    <script th:src="@{/assets/libs/select2/dist/js/select2.full.min.js}"></script>
	    <script th:src="@{/assets/libs/select2/dist/js/select2.min.js}"></script>    
	    
   		<!-- SweetAlert -->   	
    	<link th:href="@{/assets/libs/sweetalert2/dist/sweetalert2.min.css}" rel="stylesheet"/>
    	<script th:src="@{/assets/libs/sweetalert2/dist/sweetalert2.all.min.js}"></script>

	    <!-- Jquery Mask -->
	    <script th:src="@{/assets/libs/jquery.mask/jquery.mask.min.js}"></script>

	    <!-- Boostrap Validator -->
	    <link th:href="@{/assets/libs/jquery.bootstrapvalidator/0.5.2/css/bootstrapValidator.min.css}"  rel="stylesheet" type="text/css"/>
	    <script th:src="@{/assets/libs/jquery.bootstrapvalidator/0.5.2/js/bootstrapValidator.min.js}"></script>
	    <script th:src="@{/assets/libs/jquery.bootstrapvalidator/0.5.2/js/language/pt_BR.js}"></script>

		<!-- data-table styles -->	    
   		<link th:href="@{/assets/libs/datatables.net-bs4/css/dataTables.bootstrap4.css}" rel="stylesheet">
	    <link th:href="@{/assets/libs/datatables/novo/css/responsive.bootstrap4.min.css}" rel="stylesheet" type="text/css" >
	    <link th:href="@{/assets/libs/datatables/novo/css/buttons.dataTables.min.css}" rel="stylesheet" type="text/css">
	    
		<!-- data-table js -->
		<script th:src="@{/assets/libs/datatables/novo/js/jquery.dataTables.min.js}"></script>
		<script th:src="@{/assets/libs/datatables/novo/js/dataTables.buttons.min.js}"></script>
		<script th:src="@{/assets/libs/datatables/novo/js/jszip.min.js}"></script>
		<script th:src="@{/assets/libs/datatables/novo/js/pdfmake.min.js}"></script>
		<script th:src="@{/assets/libs/datatables/novo/js/vfs_fonts.js}"></script>
		<script th:src="@{/assets/libs/datatables/novo/js/buttons.flash.min.js}"></script>
		<script th:src="@{/assets/libs/datatables/novo/js/buttons.colVis.min.js}"></script>
		<script th:src="@{/assets/libs/datatables/novo/js/buttons.print.min.js}"></script>
		<script th:src="@{/assets/libs/datatables/novo/js/buttons.html5.min.js}"></script>
		<script th:src="@{/assets/libs/datatables/novo/js/dataTables.bootstrap4.min.js}"></script>
		<script th:src="@{/assets/libs/datatables/novo/js/dataTables.responsive.min.js}"></script>
	    <script th:src="@{/assets/libs/datatables/novo/js/responsive.bootstrap4.min.js}"></script>
	    
	    <script type="text/javascript" src="https://cdn.datatables.net/plug-ins/1.10.10/sorting/datetime-moment.js"></script>
     
	    <!-- Css Boostrap Validator Select2 -->
	    <style type="text/css">
	        .was-validated .custom-select:invalid + .select2 .select2-selection{
	            border-color: #f62d51!important;
	            padding-right: 2.0625rem;
	            background-repeat: no-repeat;
	            background-position: center right calc(6.0625rem / 4);
	            background-size: calc(2.0625rem / 2) calc(2.0625rem / 2);
	            background-image: url("data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' fill='%23f62d51' viewBox='-2 -2 7 7'%3e%3cpath stroke='%23d9534f' d='M0 0l3 3m0-3L0 3'/%3e%3ccircle r='.5'/%3e%3ccircle cx='3' r='.5'/%3e%3ccircle cy='3' r='.5'/%3e%3ccircle cx='3' cy='3' r='.5'/%3e%3c/svg%3E");
	        }
	        .was-validated .custom-select:valid + .select2 .select2-selection{
	            border-color: #36bea6!important;
	            padding-right: 3.29688rem;
	            background: url(../assets/images/custom-select.png) right .75rem center/8px 10px no-repeat,url("data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 8 8'%3e%3cpath fill='%2336bea6' d='M2.3 6.73L.6 4.53c-.4-1.04.46-1.4 1.1-.8l1.1 1.4 3.4-3.8c.6-.63 1.6-.27 1.2.7l-4 4.6c-.43.5-.8.4-1.1.1z'/%3e%3c/svg%3e") center right 1.75rem/1.03125rem 1.03125rem no-repeat;
	        }
	        *:focus{
	            outline:0px;
	        }
	        
	        table.dataTable > tbody > tr.child ul.dtr-details {
	            display: inline-block;
	            list-style-type: none;
	            margin: 0;
	            padding: 0;
	            width: 100%;
	        }
	
	        .help-block{
	            color: rgb(255, 255, 128)!important;
	        }
	    </style>

	    <script>
    
	   
	    	
		    function createTableReport()
		    {
		        $('table#table-report').DataTable({
		            destroy: true,
				        select:'single',
				        'paging': false,
					   	'displayLength': 500,
			   		 	'responsive': true,
					   	'order': [ [ 3, 'asc' ] ],
					   	'autoWidth': false,
						'scrollCollapse': true,
						'language': {
					           'lengthMenu': 'Mostrar _MENU_ registro(s) por pagina',
					           'zeroRecords': 'Nenhum registro encontrado',
					           'info': 'Mostrando _TOTAL_ registro(s)',
					           'infoEmpty': 'Nenhum registro encontrado',
					           'infoFiltered': '(filtrado de um total de _MAX_ registros)',
					           'search': 'Filtrar:',
					           'sLengthMenu': '_MENU_ &nbsp;registro(s) por p&aacute;gina',
					           "decimal": ",",
					           "thousands": ".",
					           'paginate': {
					               'next': 'Proximo',
					               'previous': 'Anterior'
					             }
					    }
		        });
		    }
		    	    
		    function searchCompanyMovement()
			{
		    	var hashes = window.location.href.slice(window.location.href.indexOf('?') + 1).split('&');
		    	
		    	var expirationDate = hashes[1].split('=');
		    	var bankAccountOriginId = hashes[2].split('=');
		    	var bankAccountDestinyId = hashes[3].split('=');
		    	var weekYear = hashes[4].split('=');
		    	
		    	$('form#formGetDataCompany input#expirationDate').val(decodeURIComponent(expirationDate[1]));
		    	$('form#formGetDataCompany input#bankAccountOriginId').val(bankAccountOriginId[1]);
		    	$('form#formGetDataCompany input#bankAccountDestinyId').val(bankAccountDestinyId[1]);
		    	$('form#formGetDataCompany input#weekYear').val(weekYear[1]);
		    	
		    	var form = $('form#formGetDataCompany');        
	            var dataForm = form.serializeArray();
	              
	            clearTable();
	            
	            var companyId = $('form#formGetDataCompany input#companyId').val();
	            if(''==companyId || 0==Number(companyId))
	            {
	            	return;
	            }           
		  		
		  		showLoading("Carregando dados... Por favor aguarde...");	
		  		
				$.ajax({
		            url : form.attr('action'),
					type : "POST",
					data : dataForm,
					dataType : "json"
				})
				.done(function(data, textStatus, jqXHR) 
				{	    		
					if(true==data.status)
					{
						populateTable(data);
					}
					else
					{
						hideLoading();
						showSweetalertWarning('Alerta!', data.message,'5000');
					}
				})
				.fail(function(data, textStatus, jqXHR) 
				{
					if(''!=data.message)
					{
						message = data.message;
					}
					showSweetalertWarning('Alerta!', message,'5000');
				}).always(function() 
				{
					$('#block1').hide();
					$('#block2').hide();
				});
			}
		    
		    $(function() {
	  	        $('#editable-datatable').DataTable();
	  	    });
	  	    $('#data_4').focus(function(){
	  	        $(this).calendario({
	  	            target :'#data_4',
	  	            dateDefault:$(this).val()
	  	        });
	  	    });
	  	    
	  	   function createTable()
		    { 
		    	 $('table#table-pending-itens').DataTable({
	              "paging": false
	          });

	         $('.classMotive')
					.select2({ 
						width: '100%',
						theme: "bootstrap",
						language: 
						{
							noResults: function (params) 
							{
								return "Nenhum registro encontrado.";
							}
						}
					}).on('change', function (e)
					{
	              const fildValue = this.value;
	              const fildId = this.id;
	              if(fildId.indexOf('motive_') > -1){
	                  $('form#formSave input#fildChange').val(fildId+';'+fildValue);
	              }
	              saveNewDate();
					});

	          $('.classNote')
					.on('change', function (e)
					{
	              const fildValue = this.value;
	              const fildId = this.id;
	              if(fildId.indexOf('documentNote_') > -1){
	                  $('form#formSave input#fildChange').val(fildId+';'+fildValue);
	              }
	              saveNewDate();
					});
			  }
		    
	  	   
	  	 function populateTable(data)
		    {
		    	$('div#itens-dashboardItem').html('');
		    	var trHTML = '<table id="table-pending-itens" class="table table-striped table-bordered display">';
		    	trHTML += '<thead>';
                trHTML += '<tr>';
                trHTML += '<th><b><h4>Empresa</h4></b></th>';
                //trHTML += '<th><b><h4>Data Vencimento</h4></b></th>';
                //trHTML += '<th><b><h4>Data Execu&ccedil;&atilde;o</h4></b></th>';
                //trHTML += '<th><b><h4>Ativo</h4></b></th>';
                trHTML += '<th><b><h4>Motivo</h4></b></th>';
                trHTML += '<th><b><h4>Observa&ccedil;&atilde;o</h4></b></th>';
                trHTML += '</tr>';
                trHTML += '</thead>';
                trHTML += '<tbody>';

                        if (true == data.status) {
                            $.each(data.report.itens, function (key, value) {
                                trHTML += '<tr id="6" class="gradeA">';
                                trHTML += '<td>'+value.company+'</td>';
                                /* 
                                trHTML += '<td><div class="input-group"><input class="classDate" type="text" name="expiryData_'+value.id+'" id="expiryData_'+value.id+'" size="10" maxlength="10" value="'+value.expiryData+'" readonly/><div class="input-group-append"><span class="ml-1 input-group-text"><i class="fas fa-calendar-alt"></i></span></div></div></td>';
                                if(null == value.executedData){
                              	  trHTML += '<th class="text-center"><b><h1>-</h1></b></th>'; 
                              	  }else{
                                        trHTML += '<td><div class="input-group"><input class="classDate type="text" name="executionDate_'+value.id+'" id="executionDate_'+value.id+'" size="10" maxlength="10" value="'+value.executedData+'" readonly/><div class="input-group-append"><span class="ml-1 input-group-text"><i class="fas fa-calendar-alt"></i></span></div></div></td></td>';                                                                 
                              	  }
                                if(false == value.inactive){
                                    trHTML += '<td class="text-center"><a id="inactive_'+value.id+'" name="inactive_'+value.id+'" data-toggle="tooltip" data-original-title="Inativar" onclick="inactive('+value.id+', 0, &quot;inactive_'+value.id+'&quot;);" style="cursor: pointer;" value="0"><i class="fas fa-check text-success" id="iconInactive_'+value.id+'"></i></a></td>';
                                }else{
                                    trHTML += '<td class="text-center"><a id="inactive_'+value.id+'" name="inactive_'+value.id+'" data-toggle="tooltip" data-original-title="Ativar" onclick="inactive('+value.id+', 1, &quot;inactive_'+value.id+'&quot;);" style="cursor: pointer;" value="1"><i class="fas fa-minus text-danger" id="iconInactive_'+value.id+'"></i></a></td>';
                                }
                                if(null != value.executedData){
                              	  trHTML += '<th class="text-center"><b><h1>-</h1></b></th>'; 
                              	  trHTML += '<th class="text-center"><b><h1>-</h1></b></th>'; 
                              	  }else{
      		                          trHTML += '<td class="text-center"><select class="classMotive" name="motive_'+value.id+'" id="motive_'+value.id+'"><option value="2" '+(value.motive == '2' ? 'selected' : '')+'>Baixo Movimento</option><option value="1" '+(value.motive == '1' ? 'selected' : '')+'>Negativo</option><option value="3" '+(value.motive == '3' ? 'selected' : '')+'>Outros</option></select></td>';
      		                      
      		                          if(null == value.documentNote){
      			                          trHTML += '<td class="text-center"><textarea class="classNote" id="documentNote_'+value.id+'" name="documentNote_'+value.id+'" rows="1" cols="30"></textarea></td>';

      		                          }else{
      			                          trHTML += '<td class="text-center"><textarea class="classNote" id="documentNote_'+value.id+'" name="documentNote_'+value.id+'" rows="1" cols="30">'+value.documentNote+'</textarea></td>';

      		                          }
                              	  }
                                */
                                if(1 == value.motive){
  		                          trHTML += '<td class="text-center">Negativo</td>';

                      		  }else{
		                          trHTML += '<td class="text-center"><select class="classMotive" name="motive_'+value.id+'" id="motive_'+value.id+'"><option value="0">Selecione...</option><option value="2" '+(value.motive == '2' ? 'selected' : '')+'>Baixo Movimento</option><option value="4" '+(value.motive == '4' ? 'selected' : '')+'>Bloqueado</option><option value="3" '+(value.motive == '3' ? 'selected' : '')+'>Outros</option></select></td>';
                      		  }
		                      if(null == value.documentNote){
		                    	  trHTML += '<td class="text-center"><textarea class="classNote" id="documentNote_'+value.id+'" name="documentNote_'+value.id+'" rows="1" cols="30"> </textarea></td>';
		                      }else{
		                          trHTML += '<td class="text-center"><textarea class="classNote" id="documentNote_'+value.id+'" name="documentNote_'+value.id+'" rows="1" cols="30">'+value.documentNote+'</textarea></td>';
		                      }
		                          trHTML += '</tr>';
                            });
                        }
                        
                        trHTML += '</tbody>';
                        trHTML += '<tfoot>';
                        trHTML += '<tr>';
                        trHTML += '<th><b><h4>Empresa</h4></b></th>';
                        //trHTML += '<th><b><h4>Data Vencimento</h4></b></th>';
                        //trHTML += '<th><b><h4>Data Execu&ccedil;&atilde;o</h4></b></th>';
                        //trHTML += '<th><b><h4>Ativo</h4></b></th>';
                        trHTML += '<th><b><h4>Motivo</h4></b></th>';
                        trHTML += '<th><b><h4>Observa&ccedil;&atilde;o</h4></b></th>';
      	    	
      	    	trHTML += '</tbody>';
      	    	trHTML += '</table>';
		    	
		    	$('div#itens-dashboardItem').html(trHTML);

		    	createTable();
		    }
	  	   
	  	function saveNewDate(){

	          var form = $('form#formSave');        
	          var dataForm = form.serializeArray();

	          $.ajax({
	              url : form.attr('action'),
	              type : "POST",
	              data : dataForm,
	              dataType : "json"
	          })
	          .done(function(data, textStatus, jqXHR) 
	          {	    		
	              if(true==data.status)
	       	{
	            	  showSweetalertSuccess(data.message);
					
	       	}
	       	else
	       	{
	       		showSweetalertWarning('Alerta!', data.message,'5000');
	       	}
	  	})
	  	.fail(function() 
	    	{
	  			showSweetalertWarning('Alerta!', 'Ocorreu um erro ao gravar dados.','5000');
		    }).always(function() 
		    {
	    		$('#block1').hide();
	  		$('#block2').hide();
		    });
	  	        
		}
		
	        function clearForm()
	        {
	            clearTable();
	            clearCompanySelect();
	        }
		
	        function clearTable()
	        {
	        	$('div#btnHeader').html('');
	        	$('div#btnFooter').html('');
	        	$('div#btnHeaderConfirm').html('');
	        	$('div#btnFooterConfirm').html('');
	        	$('div#report-table').html('');
	        	$('div#report-movement').html('');
	        }
	
	        function clearCompanySelect()
	        {
	            $('form#formPreview select#companyId').val('').trigger('change');
	        }
	        
		    (function() 
		    {
	            'use strict';
	            
	            /** Force input numeric only */
				$('.force-numeric-only').ForceNumericOnly();
	            
	            /**Mask to money*/
	            $('.money').mask("#.##0,00", {reverse: true});
	            
	            
		        $('form#formPreview select#companyId')
	            .select2({ 
	                width: '100%',
	                theme: "bootstrap",
	                language: 
	                {
	                    noResults: function (params) 
	                    {
	                        return "Nenhum registro encontrado.";
	                    }
	                }
	            }).on('change', function (e)
	            {
	            	$('form#formGetDataCompany input#companyId').val(this.value);
	            	searchCompanyMovement();
	            });
		        
		        const selectedCompany = $('form#formPreview input#selectedCompany').val();
                if(selectedCompany !=null && selectedCompany.length > 0){
                	$('form#formPreview select#companyId').val(selectedCompany).trigger('change');
                }
		    })();
		</script>
	</th:block>
</html>